use module io

bool test_bool_new() {
  b = bool.new()
  not b
}

bool test_bool_and() {
  true and true
}

bool test_string_eq_same() {
  'same' == 'same'
}

bool test_string_times_1() {
  'one' == 'one' * 1
}

bool test_string_times_2() {
  'oneone' == 'one' * 2
}

bool test_string_times_3() {
  'oneoneone' == 'one' * 3
}

bool test_string_length() {
   l = 'one'.length()
   l == 3
}

bool test_string_tail() {
  'ne' == tail('one')
}

bool test_string_head() {
  'o' == head('one')
}

bool test_string_at_0() {
  'o' == 'one'.at(0)
}

bool test_string_at_1() {
  'n' == 'one'.at(1)
}

bool test_ref_count_init() {
  _reflist.length() == 0
}

bool test_ref_count_add() {
  i = 10.ref() 
  _reflist.length() == 1
}

ref _make_ref() {
  i = 10.ref()
}

bool test_ref_deref() {
  i = 10.ref()
  i.deref() == 10
}

bool test_ref_count_import() {
  i = _make_ref()
  _reflist.length() == 1
}

bool test_list_new() {
  l = list.new()
  l.length() == 0
}

list _make_list() {
  l = list.new()
  l = l.push('one')
  l = l.push('two')
}

bool test_list_push() {
  l = _make_list()
  l.length() == 2
}

bool test_list_head() {
  l = _make_list()
  s = l.head()
  s == 'one'
}

bool test_list_tail() {
  l = _make_list()
  t = l.tail()
  t.at(0) == 'two'
}
  
int main(list args) {
  failures = 0
  r = test_bool_new()
  if r {
    io.println('test_bool_new ok')
  } else {
    io.println('test_bool_new FAIL')
    failures = failures + 1
  }

  r = test_bool_and()
  if r {
    io.println('test_bool_and ok')
  } else {
    io.println('test_bool_and FAIL')
    failures = failures + 1
  }

  r = test_string_eq_same()
  if r {
    io.println('test_string_eq_same ok')
  } else {
    io.println('test_string_eq_same FAIL')
    failures = failures + 1
  }

  r = test_string_times_1()
  if r {
    io.println('test_string_times_1 ok')
  } else {
    io.println('test_string_times_1 FAIL')
    failures = failures + 1
  }

  r = test_string_times_2()
  if r {
    io.println('test_string_times_2 ok')
  } else {
    io.println('test_string_times_2 FAIL')
    failures = failures + 1
  }

  r = test_string_times_3()
  if r {
    io.println('test_string_times_3 ok')
  } else {
    io.println('test_string_times_3 FAIL')
    failures = failures + 1
  }

  r = test_string_length()
  if r {
    io.println('test_string_length ok')
  } else {
    io.println('test_string_length FAIL')
    failures = failures + 1
  }

  r = test_string_tail()
  if r {
    io.println('test_string_tail ok')
  } else {
    io.println('test_string_tail FAIL')
    failures = failures + 1
  }

  r = test_string_head()
  if r {
    io.println('test_string_head ok')
  } else {
    io.println('test_string_head FAIL')
    failures = failures + 1
  }

  r = test_string_at_0()
  if r {
    io.println('test_string_at_0 ok')
  } else {
    io.println('test_string_at_0 FAIL')
    failures = failures + 1
  }

  r = test_string_at_1()
  if r {
    io.println('test_string_at_1 ok')
  } else {
    io.println('test_string_at_1 FAIL')
    failures = failures + 1
  }

  r = test_ref_count_init()
  if r {
    io.println('test_ref_count_init ok')
  } else {
    io.println('test_ref_count_init FAIL')
  }

  r = test_ref_count_add()
  if r {
    io.println('test_ref_count_add ok')
  } else {
    io.println('test_ref_count_add FAIL')
  }

  r = test_ref_deref()
  if r {
    io.println('test_ref_deref ok')
  } else {
    io.println('test_ref_deref FAIL')
  }

  r = test_ref_count_import()
  if r {
    io.println('test_ref_count_import ok')
  } else {
    io.println('test_ref_count_import FAIL')
  }

  r = test_list_new()
  if r {
    io.println('test_list_new ok')
  } else {
    io.println('test_list_new FAIL')
  }

  r = test_list_push()
  if r {
    io.println('test_list_push ok')
  } else {
    io.println('test_list_push FAIL')
  }

  r = test_list_head()
  if r {
    io.println('test_list_head ok')
  } else {
    io.println('test_list_head FAIL')
  }

  r = test_list_tail()
  if r {
    io.println('test_list_tail ok')
  } else {
    io.println('test_list_tail FAIL')
  }

  failures
}
